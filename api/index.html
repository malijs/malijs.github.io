<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Classes | Mali</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="Minimalistic Node.js gRPC microservice framework">
    
    <link rel="preload" href="/assets/css/0.styles.8e4227c1.css" as="style"><link rel="preload" href="/assets/js/app.b3b06419.js" as="script"><link rel="preload" href="/assets/js/2.4707954d.js" as="script"><link rel="preload" href="/assets/js/8.6ad20c97.js" as="script"><link rel="prefetch" href="/assets/js/10.6d148e69.js"><link rel="prefetch" href="/assets/js/11.18e97834.js"><link rel="prefetch" href="/assets/js/12.713328d9.js"><link rel="prefetch" href="/assets/js/13.a312c970.js"><link rel="prefetch" href="/assets/js/14.13db4849.js"><link rel="prefetch" href="/assets/js/15.fe68649a.js"><link rel="prefetch" href="/assets/js/16.6fdb2c7e.js"><link rel="prefetch" href="/assets/js/17.1bdf7438.js"><link rel="prefetch" href="/assets/js/18.84a7efb3.js"><link rel="prefetch" href="/assets/js/19.c229beae.js"><link rel="prefetch" href="/assets/js/20.82e2b10b.js"><link rel="prefetch" href="/assets/js/3.03d08e27.js"><link rel="prefetch" href="/assets/js/4.865692a8.js"><link rel="prefetch" href="/assets/js/5.81254301.js"><link rel="prefetch" href="/assets/js/6.6e8c67be.js"><link rel="prefetch" href="/assets/js/7.e18fffaa.js"><link rel="prefetch" href="/assets/js/9.bab437e2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8e4227c1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Mali</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/api/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  API Reference
</a></div><div class="nav-item"><a href="/examples/" class="nav-link">
  Examples
</a></div><div class="nav-item"><a href="/links/" class="nav-link">
  Links
</a></div><div class="nav-item"><a href="https://gitter.im/malijs/Lobby" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Chat
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/malijs/mali" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/api/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  API Reference
</a></div><div class="nav-item"><a href="/examples/" class="nav-link">
  Examples
</a></div><div class="nav-item"><a href="/links/" class="nav-link">
  Links
</a></div><div class="nav-item"><a href="https://gitter.im/malijs/Lobby" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Chat
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/malijs/mali" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/" aria-current="page" class="active sidebar-link">Classes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/#classes" class="sidebar-link">Classes</a></li><li class="sidebar-sub-header"><a href="/api/#mali-⇐-emitter" class="sidebar-link">Mali ⇐</a></li><li class="sidebar-sub-header"><a href="/api/#context" class="sidebar-link">Context</a></li><li class="sidebar-sub-header"><a href="/api/#request" class="sidebar-link">Request</a></li><li class="sidebar-sub-header"><a href="/api/#response" class="sidebar-link">Response</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="classes"><a href="#classes" class="header-anchor">#</a> Classes</h2> <dl><dt><a href="#Mali">Mali</a> ⇐ <code>Emitter</code></dt> <dd><p>Represents a gRPC service</p></dd> <dt><a href="#Context">Context</a></dt> <dd><p>Represents the application and call context. Clients to not create this. Mali does it for us.</p></dd> <dt><a href="#Request">Request</a></dt> <dd><p>Mali Request class that encapsulates the request of a call.
Clients to not create this. Mali does it for us.</p></dd> <dt><a href="#Response">Response</a></dt> <dd><p>Mali Response class that encapsulates the response of a call.
Clients to not create this. Mali does it for us.</p></dd></dl> <p><a name="Mali"></a></p> <h2 id="mali-⇐-emitter"><a href="#mali-⇐-emitter" class="header-anchor">#</a> Mali ⇐ <code>Emitter</code></h2> <p>Represents a gRPC service</p> <p><strong>Kind</strong>: global class<br> <strong>Extends</strong>: <code>Emitter</code></p> <ul><li><a href="#Mali">Mali</a> ⇐ <code>Emitter</code> <ul><li><a href="#new_Mali_new">new Mali(proto, name, options)</a></li> <li><a href="#Mali+name">.name</a> : <code>String</code></li> <li><a href="#Mali+env">.env</a> : <code>String</code></li> <li><a href="#Mali+ports">.ports</a> : <code>Array</code></li> <li><a href="#Mali+silent">.silent</a> : <code>Boolean</code></li> <li><a href="#Mali+addService">.addService(proto, name, options)</a></li> <li><a href="#Mali+use">.use(service, name, ...fns)</a></li> <li><a href="#Mali+onerror">.onerror(err)</a></li> <li><a href="#Mali+start">.start(port, creds, options)</a> ⇒ <code>Object</code></li> <li><a href="#Mali+close">.close()</a></li> <li><a href="#Mali+toJSON">.toJSON()</a> ⇒ <code>Object</code></li></ul></li></ul> <p><a name="new_Mali_new"></a></p> <h3 id="new-mali-proto-name-options"><a href="#new-mali-proto-name-options" class="header-anchor">#</a> new Mali(proto, name, options)</h3> <p>Create a gRPC service</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>proto</td> <td><code>String</code> | <code>Object</code></td> <td>Optional path to the protocol buffer definition file                              - Object specifying <code>root</code> directory and <code>file</code> to load                              - Loaded grpc object                              - The static service proto object itself</td></tr> <tr><td>name</td> <td><code>Object</code></td> <td>Optional name of the service or an array of names. Otherwise all services are used.                      In case of proto path the name of the service as defined in the proto definition.                      In case of proto object the name of the constructor.</td></tr> <tr><td>options</td> <td><code>Object</code></td> <td>Options to be passed to <code>grpc.load</code></td></tr></tbody></table> <p><strong>Example</strong> <em>(Create service dynamically)</em></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">PROTO_PATH</span> <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./protos/helloworld.proto'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mali</span><span class="token punctuation">(</span><span class="token constant">PROTO_PATH</span><span class="token punctuation">,</span> <span class="token string">'Greeter'</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>Example</strong> <em>(Create service from static definition)</em></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> services <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./static/helloworld_grpc_pb'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mali</span><span class="token punctuation">(</span>services<span class="token punctuation">,</span> <span class="token string">'GreeterService'</span><span class="token punctuation">)</span>
</code></pre></div><p><a name="Mali+name"></a></p> <h3 id="mali-name-string"><a href="#mali-name-string" class="header-anchor">#</a> mali.name : <code>String</code></h3> <p>The service name.
If multiple services are initialized, this will be equal to the first service loaded.</p> <p><strong>Kind</strong>: instance property of <a href="#Mali"><code>Mali</code></a><br> <strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 'Greeter'</span>
</code></pre></div><p><a name="Mali+env"></a></p> <h3 id="mali-env-string"><a href="#mali-env-string" class="header-anchor">#</a> mali.env : <code>String</code></h3> <p>The environment. Taken from <code>process.end.NODE_ENV</code>. Default: <code>development</code></p> <p><strong>Kind</strong>: instance property of <a href="#Mali"><code>Mali</code></a><br> <strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>env<span class="token punctuation">)</span> <span class="token comment">// 'development'</span>
</code></pre></div><p><a name="Mali+ports"></a></p> <h3 id="mali-ports-array"><a href="#mali-ports-array" class="header-anchor">#</a> mali.ports : <code>Array</code></h3> <p>The ports of the started service(s)</p> <p><strong>Kind</strong>: instance property of <a href="#Mali"><code>Mali</code></a><br> <strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>ports<span class="token punctuation">)</span> <span class="token comment">// [ 52239 ]</span>
</code></pre></div><p><a name="Mali+silent"></a></p> <h3 id="mali-silent-boolean"><a href="#mali-silent-boolean" class="header-anchor">#</a> mali.silent : <code>Boolean</code></h3> <p>Whether to supress logging errors in <code>onerror</code>. Default: <code>false</code>, that is errors will be logged to <code>stderr</code>.</p> <p><strong>Kind</strong>: instance property of <a href="#Mali"><code>Mali</code></a><br> <a name="Mali+addService"></a></p> <h3 id="mali-addservice-proto-name-options"><a href="#mali-addservice-proto-name-options" class="header-anchor">#</a> mali.addService(proto, name, options)</h3> <p>Add the service and initialize the app with the proto.
Basically this can be used if you don't have the data at app construction time for some reason.
This is different than <code>grpc.Server.addService()</code>.</p> <p><strong>Kind</strong>: instance method of <a href="#Mali"><code>Mali</code></a></p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>proto</td> <td><code>String</code> | <code>Object</code></td> <td>Path to the protocol buffer definition file                              - Object specifying <code>root</code> directory and <code>file</code> to load                              - Loaded grpc object                              - The static service proto object itself</td></tr> <tr><td>name</td> <td><code>Object</code></td> <td>Optional name of the service or an array of names. Otherwise all services are used.                      In case of proto path the name of the service as defined in the proto definition.                      In case of proto object the name of the constructor.</td></tr> <tr><td>options</td> <td><code>Object</code></td> <td>Options to be passed to <code>grpc.load</code></td></tr></tbody></table> <p><a name="Mali+use"></a></p> <h3 id="mali-use-service-name-fns"><a href="#mali-use-service-name-fns" class="header-anchor">#</a> mali.use(service, name, ...fns)</h3> <p>Define middleware and handlers.</p> <p><strong>Kind</strong>: instance method of <a href="#Mali"><code>Mali</code></a></p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>service</td> <td><code>String</code> | <code>Object</code></td> <td>Service name</td></tr> <tr><td>name</td> <td><code>String</code> | <code>function</code></td> <td>RPC name</td></tr> <tr><td>...fns</td> <td><code>function</code> | <code>Array</code></td> <td>Middleware and/or handler</td></tr></tbody></table> <p><strong>Example</strong> <em>(Define handler for RPC function 'getUser' in first service we find that has that call name.)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'getUser'</span><span class="token punctuation">,</span> getUser<span class="token punctuation">)</span>
</code></pre></div><p><strong>Example</strong> <em>(Define handler with middleware for RPC function 'getUser' in first service we find that has that call name.)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'getUser'</span><span class="token punctuation">,</span> mw1<span class="token punctuation">,</span> mw2<span class="token punctuation">,</span> getUser<span class="token punctuation">)</span>
</code></pre></div><p><strong>Example</strong> <em>(Define handler with middleware for RPC function 'getUser' in service 'MyService'. We pick first service that matches the name.)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'MyService'</span><span class="token punctuation">,</span> <span class="token string">'getUser'</span><span class="token punctuation">,</span> mw1<span class="token punctuation">,</span> mw2<span class="token punctuation">,</span> getUser<span class="token punctuation">)</span>
</code></pre></div><p><strong>Example</strong> <em>(Define handler with middleware for rpc function 'getUser' in service 'MyService' with full package name.)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'myorg.myapi.v1.MyService'</span><span class="token punctuation">,</span> <span class="token string">'getUser'</span><span class="token punctuation">,</span> mw1<span class="token punctuation">,</span> mw2<span class="token punctuation">,</span> getUser<span class="token punctuation">)</span>
</code></pre></div><p><strong>Example</strong> <em>(Using destructuring define handlers for rpc functions 'getUser' and 'deleteUser'. Here we would match the first service that has a `getUser` RPC method.)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">{</span> getUser<span class="token punctuation">,</span> deleteUser <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>Example</strong> <em>(Apply middleware to all handlers for a given service. We match first service that has the given name.)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'MyService'</span><span class="token punctuation">,</span> mw1<span class="token punctuation">)</span>
</code></pre></div><p><strong>Example</strong> <em>(Apply middleware to all handlers for a given service using full namespaced package name.)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'myorg.myapi.v1.MyService'</span><span class="token punctuation">,</span> mw1<span class="token punctuation">)</span>
</code></pre></div><p><strong>Example</strong> <em>(Using destructuring define handlers for RPC functions 'getUser' and 'deleteUser'. We match first service that has the given name.)</em></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// deleteUser has middleware mw1 and mw2</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">{</span> MyService<span class="token operator">:</span> <span class="token punctuation">{</span> getUser<span class="token punctuation">,</span> deleteUser<span class="token operator">:</span> <span class="token punctuation">[</span>mw1<span class="token punctuation">,</span> mw2<span class="token punctuation">,</span> deleteUser<span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>Example</strong> <em>(Using destructuring define handlers for RPC functions 'getUser' and 'deleteUser'.)</em></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// deleteUser has middleware mw1 and mw2</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">'myorg.myapi.v1.MyService'</span><span class="token operator">:</span> <span class="token punctuation">{</span> getUser<span class="token punctuation">,</span> deleteUser<span class="token operator">:</span> <span class="token punctuation">[</span>mw1<span class="token punctuation">,</span> mw2<span class="token punctuation">,</span> deleteUser<span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>Example</strong> <em>(Multiple services using object notation.)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>mw1<span class="token punctuation">)</span> <span class="token comment">// global for all services</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'MyService'</span><span class="token punctuation">,</span> mw2<span class="token punctuation">)</span> <span class="token comment">// applies to first matched service named 'MyService'</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token string">'myorg.myapi.v1.MyService'</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// matches MyService</span>
    sayGoodbye<span class="token operator">:</span> handler1<span class="token punctuation">,</span> <span class="token comment">// has mw1, mw2</span>
    sayHello<span class="token operator">:</span> <span class="token punctuation">[</span> mw3<span class="token punctuation">,</span> handler2 <span class="token punctuation">]</span> <span class="token comment">// has mw1, mw2, mw3</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">'myorg.myapi.v1.MyOtherService'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    saySomething<span class="token operator">:</span> handler3 <span class="token comment">// only has mw1</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><a name="Mali+onerror"></a></p> <h3 id="mali-onerror-err"><a href="#mali-onerror-err" class="header-anchor">#</a> mali.onerror(err)</h3> <p>Default error handler.</p> <p><strong>Kind</strong>: instance method of <a href="#Mali"><code>Mali</code></a></p> <table><thead><tr><th>Param</th> <th>Type</th></tr></thead> <tbody><tr><td>err</td> <td><code>Error</code></td></tr></tbody></table> <p><a name="Mali+start"></a></p> <h3 id="mali-start-port-creds-options-⇒-object"><a href="#mali-start-port-creds-options-⇒-object" class="header-anchor">#</a> mali.start(port, creds, options) ⇒ <code>Object</code></h3> <p>Start the service. All middleware and handlers have to be set up prior to calling <code>start</code>.
Throws in case we fail to bind to the given port.</p> <p><strong>Kind</strong>: instance method of <a href="#Mali"><code>Mali</code></a><br> <strong>Returns</strong>: <code>Object</code> - server - The <code>grpc.Server</code> instance</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>port</td> <td><code>String</code></td> <td>The hostport for the service. Default: <code>127.0.0.1:0</code></td></tr> <tr><td>creds</td> <td><code>Object</code></td> <td>Credentials options. Default: <code>grpc.ServerCredentials.createInsecure()</code></td></tr> <tr><td>options</td> <td><code>Object</code></td> <td>The start options to be passed to <code>grpc.Server</code> constructor.</td></tr></tbody></table> <p><strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token string">'localhost:50051'</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>Example</strong> <em>(Start same app on multiple ports)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token string">'127.0.0.1:50050'</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token string">'127.0.0.1:50051'</span><span class="token punctuation">)</span>
</code></pre></div><p><a name="Mali+close"></a></p> <h3 id="mali-close"><a href="#mali-close" class="header-anchor">#</a> mali.close()</h3> <p>Close the service(s).</p> <p><strong>Kind</strong>: instance method of <a href="#Mali"><code>Mali</code></a><br> <strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><a name="Mali+toJSON"></a></p> <h3 id="mali-tojson-⇒-object"><a href="#mali-tojson-⇒-object" class="header-anchor">#</a> mali.toJSON() ⇒ <code>Object</code></h3> <p>Return JSON representation.
We only bother showing settings.</p> <p><strong>Kind</strong>: instance method of <a href="#Mali"><code>Mali</code></a><br> <strong>Api</strong>: public<br> <a name="Context"></a></p> <h2 id="context"><a href="#context" class="header-anchor">#</a> Context</h2> <p>Represents the application and call context. Clients to not create this. Mali does it for us.</p> <p><strong>Kind</strong>: global class<br> <strong>Summary</strong>: Represents a Mali call context</p> <ul><li><a href="#Context">Context</a> <ul><li><a href="#Context+name">.name</a> : <code>String</code></li> <li><a href="#Context+fullName">.fullName</a> : <code>String</code></li> <li><a href="#Context+service">.service</a> : <code>String</code></li> <li><a href="#Context+package">.package</a> : <code>String</code></li> <li><a href="#Context+app">.app</a> : <code>Object</code></li> <li><a href="#Context+locals">.locals</a> : <code>Object</code></li> <li><a href="#Context+call">.call</a> : <code>Object</code></li> <li><a href="#Context+request">.request</a> : <code>Object</code></li> <li><a href="#Context+response">.response</a> : <code>Object</code></li> <li><a href="#Context+req">.req</a> : <code>Object</code> | <code>Stream</code></li> <li><a href="#Context+type">.type</a> : <code>String</code></li> <li><a href="#Context+metadata">.metadata</a> : <code>String</code></li> <li><a href="#Context+get">.get</a> ⇒ <code>*</code></li> <li><a href="#Context+res">.res</a> : <code>Object</code> | <code>Stream</code></li> <li><a href="#Context+set">.set</a> : <code>function</code></li> <li><a href="#Context+sendMetadata">.sendMetadata</a> : <code>function</code></li> <li><a href="#Context+getStatus">.getStatus</a> ⇒ <code>*</code></li> <li><a href="#Context+setStatus">.setStatus</a> : <code>function</code></li></ul></li></ul> <p><a name="Context+name"></a></p> <h3 id="context-name-string"><a href="#context-name-string" class="header-anchor">#</a> context.name : <code>String</code></h3> <p>The call function name.</p> <p><strong>Kind</strong>: instance property of <a href="#Context"><code>Context</code></a><br> <strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 'SayHello'</span>
</code></pre></div><p><a name="Context+fullName"></a></p> <h3 id="context-fullname-string"><a href="#context-fullname-string" class="header-anchor">#</a> context.fullName : <code>String</code></h3> <p>The full name of the call.</p> <p><strong>Kind</strong>: instance property of <a href="#Context"><code>Context</code></a><br> <strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>fullName<span class="token punctuation">)</span> <span class="token comment">// '/helloworld.Greeter/SayHello'</span>
</code></pre></div><p><a name="Context+service"></a></p> <h3 id="context-service-string"><a href="#context-service-string" class="header-anchor">#</a> context.service : <code>String</code></h3> <p>The service name of the call.</p> <p><strong>Kind</strong>: instance property of <a href="#Context"><code>Context</code></a><br> <strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>service<span class="token punctuation">)</span> <span class="token comment">// 'Greeter'</span>
</code></pre></div><p><a name="Context+package"></a></p> <h3 id="context-package-string"><a href="#context-package-string" class="header-anchor">#</a> context.package : <code>String</code></h3> <p>The package name of the call.</p> <p><strong>Kind</strong>: instance property of <a href="#Context"><code>Context</code></a><br> <strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>package<span class="token punctuation">)</span> <span class="token comment">// 'helloworld'</span>
</code></pre></div><p><a name="Context+app"></a></p> <h3 id="context-app-object"><a href="#context-app-object" class="header-anchor">#</a> context.app : <code>Object</code></h3> <p>The application instance reference.</p> <p><strong>Kind</strong>: instance property of <a href="#Context"><code>Context</code></a><br> <a name="Context+locals"></a></p> <h3 id="context-locals-object"><a href="#context-locals-object" class="header-anchor">#</a> context.locals : <code>Object</code></h3> <p>Request-scoped local variables. You can place anything you wish here.</p> <p><strong>Kind</strong>: instance property of <a href="#Context"><code>Context</code></a><br> <a name="Context+call"></a></p> <h3 id="context-call-object"><a href="#context-call-object" class="header-anchor">#</a> context.call : <code>Object</code></h3> <p>The internal gRPC call instance reference.
This is an alias to <code>ctx.request.call</code>.</p> <p><strong>Kind</strong>: instance property of <a href="#Context"><code>Context</code></a><br> <a name="Context+request"></a></p> <h3 id="context-request-object"><a href="#context-request-object" class="header-anchor">#</a> context.request : <code>Object</code></h3> <p>The call's Mali Request object.</p> <p><strong>Kind</strong>: instance property of <a href="#Context"><code>Context</code></a><br> <a name="Context+response"></a></p> <h3 id="context-response-object"><a href="#context-response-object" class="header-anchor">#</a> context.response : <code>Object</code></h3> <p>The call's Mali Response object.</p> <p><strong>Kind</strong>: instance property of <a href="#Context"><code>Context</code></a><br> <a name="Context+req"></a></p> <h3 id="context-req-object-stream"><a href="#context-req-object-stream" class="header-anchor">#</a> context.req : <code>Object</code> | <code>Stream</code></h3> <p>The call request object or stream. This is an alias to <code>ctx.request.res</code>.</p> <p><strong>Kind</strong>: instance property of <a href="#Context"><code>Context</code></a><br> <strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>req<span class="token punctuation">)</span> <span class="token comment">// { name: 'Bob' }</span>
</code></pre></div><p><a name="Context+type"></a></p> <h3 id="context-type-string"><a href="#context-type-string" class="header-anchor">#</a> context.type : <code>String</code></h3> <p>The call's type. One of <code>@malijs/call-types</code> enums.
This is an alias to <code>ctx.request.type</code>.</p> <p><strong>Kind</strong>: instance property of <a href="#Context"><code>Context</code></a><br> <strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token comment">// 'unary'</span>
</code></pre></div><p><strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>type <span class="token operator">===</span> CallType<span class="token punctuation">.</span><span class="token constant">DUPLEX</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Duplex stream call'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a name="Context+metadata"></a></p> <h3 id="context-metadata-string"><a href="#context-metadata-string" class="header-anchor">#</a> context.metadata : <code>String</code></h3> <p>The call's request metadata plain object.
This is an alias to <code>ctx.request.metadata</code>.</p> <p><strong>Kind</strong>: instance property of <a href="#Context"><code>Context</code></a><br> <strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>metadata<span class="token punctuation">)</span>
<span class="token comment">// { 'user-agent': 'grpc-node/1.7.1 grpc-c/1.7.1 (osx; chttp2)' }</span>
</code></pre></div><p><a name="Context+get"></a></p> <h3 id="context-get-⇒"><a href="#context-get-⇒" class="header-anchor">#</a> context.get ⇒ <code>*</code></h3> <p>Get request metadata value
This is an alias to <code>ctx.request.get()</code>.</p> <p><strong>Kind</strong>: instance property of <a href="#Context"><code>Context</code></a><br> <strong>Returns</strong>: <code>*</code> - the metadata field value</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>field</td> <td><code>String</code></td> <td>the field name</td></tr></tbody></table> <p><strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'user-agent'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 'grpc-node/1.7.1 grpc-c/1.7.1 (osx; chttp2)'</span>
</code></pre></div><p><a name="Context+res"></a></p> <h3 id="context-res-object-stream"><a href="#context-res-object-stream" class="header-anchor">#</a> context.res : <code>Object</code> | <code>Stream</code></h3> <p>The response object or stream. Should be set in handler.
This is an alias to <code>ctx.response.res</code>.</p> <p><strong>Kind</strong>: instance property of <a href="#Context"><code>Context</code></a><br> <strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>res <span class="token operator">=</span> <span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">'Hello World!'</span> <span class="token punctuation">}</span>
</code></pre></div><p><a name="Context+set"></a></p> <h3 id="context-set-function"><a href="#context-set-function" class="header-anchor">#</a> context.set : <code>function</code></h3> <p>Set response header metadata value.
This is an alias to <code>ctx.response.set()</code>.</p> <p><strong>Kind</strong>: instance property of <a href="#Context"><code>Context</code></a></p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>field</td> <td><code>String</code> | <code>Object</code></td> <td>the metadata field name or object for metadata</td></tr> <tr><td>val</td> <td><code>*</code></td> <td>the value of the field</td></tr></tbody></table> <p><strong>Example</strong> <em>(Using string field name and value)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>Example</strong> <em>(Using object)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  foo<span class="token operator">:</span> <span class="token string">'bar'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><a name="Context+sendMetadata"></a></p> <h3 id="context-sendmetadata-function"><a href="#context-sendmetadata-function" class="header-anchor">#</a> context.sendMetadata : <code>function</code></h3> <p>Send response header metadata.
This is an alias to <code>ctx.response.sendMetadata()</code>.</p> <p><strong>Kind</strong>: instance property of <a href="#Context"><code>Context</code></a></p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>md</td> <td><code>Object</code></td> <td>optional header metadata object to set into the request before sending                    if there is existing metadata in the response it is cleared                    if param is not provided <code>sendMetadata</code> sends the existing metadata in the response</td></tr></tbody></table> <p><strong>Example</strong> <em>(Set and send)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span><span class="token function">sendMetadata</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  foo<span class="token operator">:</span> <span class="token string">'bar'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>Example</strong> <em>(Set and send later)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">)</span>
<span class="token comment">// ... later</span>
ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">sendMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><a name="Context+getStatus"></a></p> <h3 id="context-getstatus-⇒"><a href="#context-getstatus-⇒" class="header-anchor">#</a> context.getStatus ⇒ <code>*</code></h3> <p>Get response status / trailer metadata value.
This is an alias to <code>ctx.response.getStatus()</code>.</p> <p><strong>Kind</strong>: instance property of <a href="#Context"><code>Context</code></a><br> <strong>Returns</strong>: <code>*</code> - the metadata field value
console.log(ctx.getStatus('foo')) // 'bar'</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>field</td> <td><code>String</code></td> <td>the field name</td></tr></tbody></table> <p><a name="Context+setStatus"></a></p> <h3 id="context-setstatus-function"><a href="#context-setstatus-function" class="header-anchor">#</a> context.setStatus : <code>function</code></h3> <p>Set response status / trailer metadata value.
This is an alias to <code>ctx.response.setStatus()</code>.</p> <p><strong>Kind</strong>: instance property of <a href="#Context"><code>Context</code></a></p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>field</td> <td><code>String</code> | <code>Object</code></td> <td>the metadata field name or object for metadata</td></tr> <tr><td>val</td> <td><code>*</code></td> <td>the value of the field</td></tr></tbody></table> <p><strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>Example</strong> <em>(Using object)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  foo<span class="token operator">:</span> <span class="token string">'bar'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><a name="Request"></a></p> <h2 id="request"><a href="#request" class="header-anchor">#</a> Request</h2> <p>Mali Request class that encapsulates the request of a call.
Clients to not create this. Mali does it for us.</p> <p><strong>Kind</strong>: global class</p> <ul><li><a href="#Request">Request</a> <ul><li><a href="#new_Request_new">new Request(call, type)</a></li> <li><a href="#Request+call">.call</a> : <code>Object</code></li> <li><a href="#Request+req">.req</a> : <code>Object</code> | <code>Stream</code></li> <li><a href="#Request+metadata">.metadata</a> : <code>Object</code></li> <li><a href="#Request+type">.type</a> : <code>String</code></li> <li><a href="#Request+getMetadata">.getMetadata()</a> ⇒ <code>Object</code></li> <li><a href="#Request+get">.get(field)</a> ⇒ <code>*</code></li></ul></li></ul> <p><a name="new_Request_new"></a></p> <h3 id="new-request-call-type"><a href="#new-request-call-type" class="header-anchor">#</a> new Request(call, type)</h3> <p>Creates a Mali Request instance</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>call</td> <td><code>Object</code></td> <td>the grpc call instance</td></tr> <tr><td>type</td> <td><code>String</code></td> <td>the call type. one of <code>@malijs/call-types</code> enums.</td></tr></tbody></table> <p><a name="Request+call"></a></p> <h3 id="request-call-object"><a href="#request-call-object" class="header-anchor">#</a> request.call : <code>Object</code></h3> <p>The internal gRPC call instance reference.</p> <p><strong>Kind</strong>: instance property of <a href="#Request"><code>Request</code></a><br> <a name="Request+req"></a></p> <h3 id="request-req-object-stream"><a href="#request-req-object-stream" class="header-anchor">#</a> request.req : <code>Object</code> | <code>Stream</code></h3> <p>The call request object or stream.</p> <p><strong>Kind</strong>: instance property of <a href="#Request"><code>Request</code></a><br> <strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>req<span class="token punctuation">)</span> <span class="token comment">// { name: 'Bob' }</span>
</code></pre></div><p><a name="Request+metadata"></a></p> <h3 id="request-metadata-object"><a href="#request-metadata-object" class="header-anchor">#</a> request.metadata : <code>Object</code></h3> <p>The call's request metadata plain object if present.</p> <p><strong>Kind</strong>: instance property of <a href="#Request"><code>Request</code></a><br> <strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>metadata<span class="token punctuation">)</span>
<span class="token comment">// { 'user-agent': 'grpc-node/1.7.1 grpc-c/1.7.1 (osx; chttp2)' }</span>
</code></pre></div><p><a name="Request+type"></a></p> <h3 id="request-type-string"><a href="#request-type-string" class="header-anchor">#</a> request.type : <code>String</code></h3> <p>The call's type. One of <code>@malijs/call-types</code> enums.</p> <p><strong>Kind</strong>: instance property of <a href="#Request"><code>Request</code></a><br> <strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token comment">// 'unary'</span>
</code></pre></div><p><strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>type <span class="token operator">===</span> CallType<span class="token punctuation">.</span><span class="token constant">DUPLEX</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Duplex stream call'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a name="Request+getMetadata"></a></p> <h3 id="request-getmetadata-⇒-object"><a href="#request-getmetadata-⇒-object" class="header-anchor">#</a> request.getMetadata() ⇒ <code>Object</code></h3> <p>Gets the requests metadata as a <code>grpc.Metadata</code> object instance</p> <p><strong>Kind</strong>: instance method of <a href="#Request"><code>Request</code></a><br> <strong>Returns</strong>: <code>Object</code> - request metadata<br> <a name="Request+get"></a></p> <h3 id="request-get-field-⇒"><a href="#request-get-field-⇒" class="header-anchor">#</a> request.get(field) ⇒ <code>*</code></h3> <p>Gets specific request metadata field value</p> <p><strong>Kind</strong>: instance method of <a href="#Request"><code>Request</code></a><br> <strong>Returns</strong>: <code>*</code> - the metadata value for the field</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>field</td> <td><code>*</code></td> <td>the metadata field name</td></tr></tbody></table> <p><strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 'bar'</span>
</code></pre></div><p><a name="Response"></a></p> <h2 id="response"><a href="#response" class="header-anchor">#</a> Response</h2> <p>Mali Response class that encapsulates the response of a call.
Clients to not create this. Mali does it for us.</p> <p><strong>Kind</strong>: global class</p> <ul><li><a href="#Response">Response</a> <ul><li><a href="#new_Response_new">new Response(call, type)</a></li> <li><a href="#Response+call">.call</a> : <code>Object</code></li> <li><a href="#Response+type">.type</a> : <code>String</code></li> <li><a href="#Response+metadata">.metadata</a> : <code>Object</code></li> <li><a href="#Response+status">.status</a> : <code>Object</code></li> <li><a href="#Response+res">.res</a> : <code>Object</code> | <code>Stream</code></li> <li><a href="#Response+set">.set(field, val)</a></li> <li><a href="#Response+get">.get(field)</a> ⇒ <code>*</code></li> <li><a href="#Response+getMetadata">.getMetadata()</a> ⇒ <code>Object</code></li> <li><a href="#Response+sendMetadata">.sendMetadata(md)</a></li> <li><a href="#Response+getStatus">.getStatus(field)</a> ⇒ <code>*</code></li> <li><a href="#Response+setStatus">.setStatus(field, val)</a></li> <li><a href="#Response+getStatusMetadata">.getStatusMetadata()</a> ⇒ <code>Object</code></li></ul></li></ul> <p><a name="new_Response_new"></a></p> <h3 id="new-response-call-type"><a href="#new-response-call-type" class="header-anchor">#</a> new Response(call, type)</h3> <p>Creates a Mali Response instance</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>call</td> <td><code>Object</code></td> <td>the grpc call instance</td></tr> <tr><td>type</td> <td><code>String</code></td> <td>the call type. one of <code>@malijs/call-types</code> enums.</td></tr></tbody></table> <p><a name="Response+call"></a></p> <h3 id="response-call-object"><a href="#response-call-object" class="header-anchor">#</a> response.call : <code>Object</code></h3> <p>The internal gRPC call instance reference.</p> <p><strong>Kind</strong>: instance property of <a href="#Response"><code>Response</code></a><br> <a name="Response+type"></a></p> <h3 id="response-type-string"><a href="#response-type-string" class="header-anchor">#</a> response.type : <code>String</code></h3> <p>The call's type. One of <code>@malijs/call-types</code> enums.
This will match Request's type.</p> <p><strong>Kind</strong>: instance property of <a href="#Response"><code>Response</code></a><br> <strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token comment">// 'unary'</span>
</code></pre></div><p><a name="Response+metadata"></a></p> <h3 id="response-metadata-object"><a href="#response-metadata-object" class="header-anchor">#</a> response.metadata : <code>Object</code></h3> <p>The call's response header metadata plain object if present.</p> <p><strong>Kind</strong>: instance property of <a href="#Response"><code>Response</code></a><br> <strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span>metadata<span class="token punctuation">)</span>  <span class="token comment">// { 'foo': 'bar' }</span>
</code></pre></div><p><a name="Response+status"></a></p> <h3 id="response-status-object"><a href="#response-status-object" class="header-anchor">#</a> response.status : <code>Object</code></h3> <p>The call's response trailer / status metadata plain object if present.</p> <p><strong>Kind</strong>: instance property of <a href="#Response"><code>Response</code></a><br> <strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token string">'biz'</span><span class="token punctuation">,</span> <span class="token string">'baz'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span>status<span class="token punctuation">)</span> <span class="token comment">// { biz: 'baz' }</span>
</code></pre></div><p><a name="Response+res"></a></p> <h3 id="response-res-object-stream"><a href="#response-res-object-stream" class="header-anchor">#</a> response.res : <code>Object</code> | <code>Stream</code></h3> <p>The call's response actual payload object / stream.
In case of <code>DUPLEX</code> call this is automatically set the actual <code>call</code> instance.</p> <p><strong>Kind</strong>: instance property of <a href="#Response"><code>Response</code></a><br> <strong>Example</strong> <em>(UNARY or REQUEST STREAM calls)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span>res <span class="token operator">=</span> <span class="token punctuation">{</span> foo<span class="token operator">:</span> <span class="token string">'bar'</span> <span class="token punctuation">}</span>
</code></pre></div><p><strong>Example</strong> <em>(RESPONSE STREAM calls)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span>res <span class="token operator">=</span> <span class="token function">createResponseStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>Example</strong> <em>(DUPLEX calls)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span>res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">{</span> foo<span class="token operator">:</span> <span class="token string">'bar'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>Example</strong> <em>(Custom Response Stream calls)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span>res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Response</span><span class="token punctuation">(</span><span class="token punctuation">{</span> object<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span>res<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> data<span class="token operator">:</span> <span class="token string">'hello 1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span>res<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> data<span class="token operator">:</span> <span class="token string">'hello 2'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span>res<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> data<span class="token operator">:</span> <span class="token string">'hello 3'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span>res<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="Response+set"></a></p> <h3 id="response-set-field-val"><a href="#response-set-field-val" class="header-anchor">#</a> response.set(field, val)</h3> <p>Sets specific response header metadata field value</p> <p><strong>Kind</strong>: instance method of <a href="#Response"><code>Response</code></a></p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>field</td> <td><code>String</code> | <code>Object</code></td> <td>the metadata field name or object for metadata</td></tr> <tr><td>val</td> <td><code>*</code></td> <td>the value of the field</td></tr></tbody></table> <p><strong>Example</strong> <em>(Using string field name and value)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>Example</strong> <em>(Using object)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  foo<span class="token operator">:</span> <span class="token string">'bar'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><a name="Response+get"></a></p> <h3 id="response-get-field-⇒"><a href="#response-get-field-⇒" class="header-anchor">#</a> response.get(field) ⇒ <code>*</code></h3> <p>Gets the response header metadata value</p> <p><strong>Kind</strong>: instance method of <a href="#Response"><code>Response</code></a><br> <strong>Returns</strong>: <code>*</code> - the metadata field value</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>field</td> <td><code>String</code></td> <td>the field name</td></tr></tbody></table> <p><strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 'bar'</span>
</code></pre></div><p><a name="Response+getMetadata"></a></p> <h3 id="response-getmetadata-⇒-object"><a href="#response-getmetadata-⇒-object" class="header-anchor">#</a> response.getMetadata() ⇒ <code>Object</code></h3> <p>Gets the response metadata as a <code>grpc.Metadata</code> object instance</p> <p><strong>Kind</strong>: instance method of <a href="#Response"><code>Response</code></a><br> <strong>Returns</strong>: <code>Object</code> - response metadata<br> <a name="Response+sendMetadata"></a></p> <h3 id="response-sendmetadata-md"><a href="#response-sendmetadata-md" class="header-anchor">#</a> response.sendMetadata(md)</h3> <p>Sends the response header metadata. Optionally (re)sets the header metadata as well.</p> <p><strong>Kind</strong>: instance method of <a href="#Response"><code>Response</code></a></p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>md</td> <td><code>Object</code></td> <td>optional header metadata object to set into the request before sending                    if there is existing metadata in the response it is cleared                    if param is not provided <code>sendMetadata</code> sends the existing metadata in the response</td></tr></tbody></table> <p><strong>Example</strong> <em>(Set and send)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">sendMetadata</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  foo<span class="token operator">:</span> <span class="token string">'bar'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>Example</strong> <em>(Set and send later)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">)</span>
<span class="token comment">// ... later</span>
ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">sendMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><a name="Response+getStatus"></a></p> <h3 id="response-getstatus-field-⇒"><a href="#response-getstatus-field-⇒" class="header-anchor">#</a> response.getStatus(field) ⇒ <code>*</code></h3> <p>Gets the response status / trailer metadata value</p> <p><strong>Kind</strong>: instance method of <a href="#Response"><code>Response</code></a><br> <strong>Returns</strong>: <code>*</code> - the metadata field value</p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>field</td> <td><code>String</code></td> <td>the field name</td></tr></tbody></table> <p><strong>Example</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 'baz'</span>
</code></pre></div><p><a name="Response+setStatus"></a></p> <h3 id="response-setstatus-field-val"><a href="#response-setstatus-field-val" class="header-anchor">#</a> response.setStatus(field, val)</h3> <p>Sets specific response status / trailer metadata field value</p> <p><strong>Kind</strong>: instance method of <a href="#Response"><code>Response</code></a></p> <table><thead><tr><th>Param</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>field</td> <td><code>String</code> | <code>Object</code></td> <td>the metadata field name or object for metadata</td></tr> <tr><td>val</td> <td><code>*</code></td> <td>the value of the field</td></tr></tbody></table> <p><strong>Example</strong> <em>(Using string field name and value)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>Example</strong> <em>(Using object)</em></p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  foo<span class="token operator">:</span> <span class="token string">'bar'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><a name="Response+getStatusMetadata"></a></p> <h3 id="response-getstatusmetadata-⇒-object"><a href="#response-getstatusmetadata-⇒-object" class="header-anchor">#</a> response.getStatusMetadata() ⇒ <code>Object</code></h3> <p>Gets the response status / trailer metadata as a <code>grpc.Metadata</code> object instance</p> <p><strong>Kind</strong>: instance method of <a href="#Response"><code>Response</code></a><br> <strong>Returns</strong>: <code>Object</code> - response status / trailer metadata</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b3b06419.js" defer></script><script src="/assets/js/2.4707954d.js" defer></script><script src="/assets/js/8.6ad20c97.js" defer></script>
  </body>
</html>
